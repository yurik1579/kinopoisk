"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9523],{77554:function(e,n,i){i.d(n,{C:function(){return m},W:function(){return o}});var a=i(24164),l=i(37579),d=i(37873),t=i(47418);function*m(){const e=yield(0,a.select)(d.u);null!==e&&void 0!==e&&e.length||(yield(0,a.call)(t.u))}function*o(){yield(0,a.takeLatest)(l.F.type,m)}},25933:function(e,n,i){i.d(n,{g:function(){return l},h:function(){return a}});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MoviePreviewUserData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Movie"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folders"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"public"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"voting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"votedAt"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"MoviePreviewCard"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"movieId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Long"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actorsLimit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"withUserData"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"regionId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"213"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"movie"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"movieId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"title"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"russian"}},{kind:"Field",name:{kind:"Name",value:"original"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Film"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productionYear"}},{kind:"Field",name:{kind:"Name",value:"isShortFilm"}},{kind:"Field",name:{kind:"Name",value:"top250"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TvSeries"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MiniSeries"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TvShow"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Video"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productionYear"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"isTicketsAvailable"},arguments:[{kind:"Argument",name:{kind:"Name",value:"regionId"},value:{kind:"Variable",name:{kind:"Name",value:"regionId"}}}]},{kind:"Field",name:{kind:"Name",value:"viewOption"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"buttonText"}},{kind:"Field",name:{kind:"Name",value:"originalButtonText"}},{kind:"Field",alias:{kind:"Name",value:"isAvailableOnline"},name:{kind:"Name",value:"isWatchable"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"anyDevice"},value:{kind:"BooleanValue",value:!1}},{kind:"ObjectField",name:{kind:"Name",value:"anyRegion"},value:{kind:"BooleanValue",value:!1}}]}}]},{kind:"Field",name:{kind:"Name",value:"purchasabilityStatus"}},{kind:"Field",name:{kind:"Name",value:"promotionIcons"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarsUrl"}},{kind:"Field",name:{kind:"Name",value:"fallbackUrl"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rightholderLogoUrlForPoster"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",alias:{kind:"Name",value:"actors"},name:{kind:"Name",value:"members"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"actorsLimit"}}},{kind:"Argument",name:{kind:"Name",value:"role"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"ACTOR"},{kind:"EnumValue",value:"CAMEO"},{kind:"EnumValue",value:"UNCREDITED"}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"person"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"originalName"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"total"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",alias:{kind:"Name",value:"directors"},name:{kind:"Name",value:"members"},arguments:[{kind:"Argument",name:{kind:"Name",value:"role"},value:{kind:"EnumValue",value:"DIRECTOR"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"4"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"person"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"originalName"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"rating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"kinopoisk"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isActive"}},{kind:"Field",name:{kind:"Name",value:"count"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"expectation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isActive"}},{kind:"Field",name:{kind:"Name",value:"count"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"poster"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarsUrl"}},{kind:"Field",name:{kind:"Name",value:"fallbackUrl"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MoviePreviewUserData"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"withUserData"}}}]}]},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"MoviePreviewUserData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Movie"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folders"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"public"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"voting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"votedAt"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}},83113:function(e,n,i){i.d(n,{bC:function(){return d},bK:function(){return t}});var a=i(17870);let l;!function(e){e.SetMovieUserFolderEffect="preview-card-popover-content/SET_MOVIE_USER_FOLDER_EFFECT",e.SetMovieUserRatingEffect="preview-card-popover-content/SET_MOVIE_USER_RATING_EFFECT"}(l||(l={}));const d=(0,a.PH)(l.SetMovieUserRatingEffect),t=(0,a.PH)(l.SetMovieUserFolderEffect)},79523:function(e,n,i){i.d(n,{D:function(){return U}});var a=i(77554),l=i(23058),d=i(83113);var t=i(24164),m=i(67905),o=i(7053),k=i(70451),u=i(92892),v=i(25933),r=i(7119),s=i(19450),c=i(44828),N=i(31728);function*p(e){var n,i;let{payload:{movieId:a,folderId:l,typeName:d,operation:p}}=e;yield(0,t.call)(o.K);const F=yield(0,t.select)((e=>(0,k.S)(e,{entityId:l}))),y=(0,c.u)(d)({id:a}),S=yield(0,t.call)(u.R),f=S.readFragment({id:y,fragment:v.h}),_=null===f||void 0===f||null===(n=f.userData)||void 0===n||null===(i=n.folders)||void 0===i?void 0:i.some((e=>(null===e||void 0===e?void 0:e.id)===l));let g=null;p!==m.Y.Add||_||(g=(0,r.C)({userData:f,folder:F,typeName:d})),p===m.Y.Remove&&_&&(g=(0,s.Z)({userData:f,folder:F,typeName:d})),g&&(0,N.g)({apolloClient:S,cacheObjectId:y,data:g,fragment:v.h})}var F=i(55330),y=i(47805),S=i(58711);const f={[F.v.Film]:y.MovieTypes.Film,[F.v.TvSeries]:y.MovieTypes.TvSeries,[F.v.Video]:y.MovieTypes.Video,[F.v.TvShow]:y.MovieTypes.TvShow,[F.v.MiniSeries]:y.MovieTypes.MiniSeries};function*_(e){let{payload:n}=e;const{movieId:i,folderId:a,operation:l,typeName:d}=n;return yield(0,S.K)({movieId:i,folderId:a,operation:l,movieType:f[d]})}var g=i(84689);function b(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,a)}return i}function D(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?b(Object(i),!0).forEach((function(n){(0,g.Z)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function*I(e){let{payload:n}=e;const{operation:i}=n,a=(0,d.bK)(D(D({},n),{},{operation:i===m.Y.Add?m.Y.Remove:m.Y.Add}));yield(0,t.call)(p,a)}function*T(){yield(0,l.f)(200,(e=>{let{payload:n}=e;return`${n.movieId}${n.folderId}`}),d.bK.type,p,_,I)}var V=i(34381),O=i(22860);function A(e){let{movieId:n,value:i,voteAt:a,typeName:l,apolloClient:d}=e;const t=(0,c.u)(l)({id:n}),m=function(e){let{ratingValue:n,userData:i,typeName:a,voteAt:l=(new Date).toISOString()}=e;return(0,V.ZP)(i,(e=>((e=e||{__typename:a,userData:null}).userData=e.userData||{__typename:F.v.MovieUserData,folders:null,voting:null},e.userData.voting=e.userData.voting||{__typename:F.v.Vote,value:null,votedAt:null},e.userData.voting.value=n===O.UF?null:n,e.userData.voting.votedAt=l,e)))}({ratingValue:i,voteAt:a,userData:d.readFragment({id:t,fragment:v.h}),typeName:l});(0,N.g)({apolloClient:d,cacheObjectId:t,data:m,fragment:v.h})}function*C(e){let{payload:{movieId:n,value:i,typeName:a}}=e;yield(0,t.call)(o.K);A({apolloClient:yield(0,t.call)(u.R),movieId:n,value:i,typeName:a})}var E=i(49249);function*h(e){let{payload:n}=e;const{movieId:i,value:a}=n,l=yield function*(e){let{movieId:n,value:i}=e;const a=yield(0,t.call)(E.z);return yield(0,t.call)({context:a,fn:a.setUserVote},{id:n,value:i})}({movieId:i,value:a});return l}function*w(e){let{payload:{movieId:n,typeName:i,rollbackVote:a}}=e;A({apolloClient:yield(0,t.call)(u.R),movieId:n,value:(null===a||void 0===a?void 0:a.value)||null,typeName:i,voteAt:null===a||void 0===a?void 0:a.votedAt})}function*M(){yield(0,l.f)(200,(e=>{let{payload:n}=e;return String(n.movieId)}),d.bC.type,C,h,w)}const U=()=>[{id:"previewCardPopoverContent",sagas:[a.W,T,M]}]}}]);
//# sourceMappingURL=https://kinopoisk-frontend-internal.s3.mds.yandex.net/frontend-www/release/_next/static/chunks/9523-c1c26ec70825ad70.js.map